!-----------------------------------------------------------------------------
! (C) Crown copyright 2018 Met Office. All rights reserved.
! The file LICENCE, distributed with this code, contains details of the terms
! under which the code may be used.
!-----------------------------------------------------------------------------

module get_unit_test_q3x3x3_basis_mod
! A module containing a collection of helper routines that provide canned
! basis functions (and differential basis functions) for lowest order
! function spaces with a 3x3x3 quadrature for use when writing
! unit tests of kernels

  use constants_mod, only : r_def

  implicit none

  private

  public :: get_w0_q3x3x3_basis,            &
            get_w0_q3x3x3_diff_basis,       &
            get_w1_q3x3x3_basis,            &
            get_w1_q3x3x3_diff_basis,       &
            get_w2_q3x3x3_basis,            &
            get_w2_q3x3x3_diff_basis,       &
            get_w2v_q3x3x3_basis,           &
            get_w2v_q3x3x3_diff_basis,      &
            get_w2h_q3x3x3_basis,           &
            get_w2h_q3x3x3_diff_basis,      &
            get_w2broken_q3x3x3_basis,      &
            get_w2broken_q3x3x3_diff_basis, &
            get_w2trace_q3x3x3_basis,       &
            get_w2trace_q3x3x3_diff_basis,  &
            get_w3_q3x3x3_basis,            &
            get_w3_q3x3x3_diff_basis,       &
            get_wtheta_q3x3x3_basis,        &
            get_wtheta_q3x3x3_diff_basis,   &
            get_wchi_q3x3x3_basis,          &
            get_wchi_q3x3x3_diff_basis

  contains

!---------------------------------------------------------------------

  subroutine get_w0_q3x3x3_basis(basis_w0)
    ! Return the basis function for a field on a W0 function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_w0(:,:,:,:)

    allocate(basis_w0(1,8,9,3))
    basis_w0 = reshape( [0.698568501158668_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                         0.088729833462074_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                         0.001431498841332_r_def, 0.011270166537926_r_def, 0.393649167310371_r_def, &
                         0.050000000000000_r_def, 0.050000000000000_r_def, 0.393649167310371_r_def, &
                         0.050000000000000_r_def, 0.006350832689629_r_def, 0.006350832689629_r_def, &
                         0.050000000000000_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                         0.088729833462074_r_def, 0.698568501158668_r_def, 0.011270166537926_r_def, &
                         0.001431498841332_r_def, 0.011270166537926_r_def, 0.088729833462074_r_def, &
                         0.393649167310371_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                         0.050000000000000_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                         0.006350832689629_r_def, 0.006350832689629_r_def, 0.221824583655185_r_def, &
                         0.221824583655185_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                         0.028175416344815_r_def, 0.028175416344815_r_def, 0.028175416344815_r_def, &
                         0.028175416344815_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                         0.393649167310371_r_def, 0.393649167310371_r_def, 0.006350832689629_r_def, &
                         0.006350832689629_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                         0.088729833462074_r_def, 0.698568501158668_r_def, 0.088729833462074_r_def, &
                         0.011270166537926_r_def, 0.011270166537926_r_def, 0.088729833462074_r_def, &
                         0.011270166537926_r_def, 0.001431498841332_r_def, 0.050000000000000_r_def, &
                         0.393649167310371_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                         0.006350832689629_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                         0.006350832689629_r_def, 0.011270166537926_r_def, 0.088729833462074_r_def, &
                         0.698568501158668_r_def, 0.088729833462074_r_def, 0.001431498841332_r_def, &
                         0.011270166537926_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                         0.393649167310371_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                         0.050000000000000_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                         0.006350832689629_r_def, 0.050000000000000_r_def, 0.221824583655185_r_def, &
                         0.028175416344815_r_def, 0.028175416344815_r_def, 0.221824583655185_r_def, &
                         0.221824583655185_r_def, 0.028175416344815_r_def, 0.028175416344815_r_def, &
                         0.221824583655185_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                         0.050000000000000_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                         0.006350832689629_r_def, 0.050000000000000_r_def, 0.393649167310371_r_def, &
                         0.221824583655185_r_def, 0.221824583655185_r_def, 0.028175416344815_r_def, &
                         0.028175416344815_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                         0.028175416344815_r_def, 0.028175416344815_r_def, 0.125000000000000_r_def, &
                         0.125000000000000_r_def, 0.125000000000000_r_def, 0.125000000000000_r_def, &
                         0.125000000000000_r_def, 0.125000000000000_r_def, 0.125000000000000_r_def, &
                         0.125000000000000_r_def, 0.028175416344815_r_def, 0.028175416344815_r_def, &
                         0.221824583655185_r_def, 0.221824583655185_r_def, 0.028175416344815_r_def, &
                         0.028175416344815_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                         0.050000000000000_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                         0.006350832689629_r_def, 0.050000000000000_r_def, 0.393649167310371_r_def, &
                         0.050000000000000_r_def, 0.006350832689629_r_def, 0.028175416344815_r_def, &
                         0.221824583655185_r_def, 0.221824583655185_r_def, 0.028175416344815_r_def, &
                         0.028175416344815_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                         0.028175416344815_r_def, 0.006350832689629_r_def, 0.050000000000000_r_def, &
                         0.393649167310371_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                         0.050000000000000_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                         0.088729833462074_r_def, 0.011270166537926_r_def, 0.001431498841332_r_def, &
                         0.011270166537926_r_def, 0.698568501158668_r_def, 0.088729833462074_r_def, &
                         0.011270166537926_r_def, 0.088729833462074_r_def, 0.050000000000000_r_def, &
                         0.006350832689629_r_def, 0.006350832689629_r_def, 0.050000000000000_r_def, &
                         0.393649167310371_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                         0.393649167310371_r_def, 0.011270166537926_r_def, 0.001431498841332_r_def, &
                         0.011270166537926_r_def, 0.088729833462074_r_def, 0.088729833462074_r_def, &
                         0.011270166537926_r_def, 0.088729833462074_r_def, 0.698568501158668_r_def, &
                         0.050000000000000_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                         0.006350832689629_r_def, 0.393649167310371_r_def, 0.393649167310371_r_def, &
                         0.050000000000000_r_def, 0.050000000000000_r_def, 0.028175416344815_r_def, &
                         0.028175416344815_r_def, 0.028175416344815_r_def, 0.028175416344815_r_def, &
                         0.221824583655185_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                         0.221824583655185_r_def, 0.006350832689629_r_def, 0.006350832689629_r_def, &
                         0.050000000000000_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                         0.050000000000000_r_def, 0.393649167310371_r_def, 0.393649167310371_r_def, &
                         0.011270166537926_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                         0.001431498841332_r_def, 0.088729833462074_r_def, 0.698568501158668_r_def, &
                         0.088729833462074_r_def, 0.011270166537926_r_def, 0.006350832689629_r_def, &
                         0.050000000000000_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                         0.050000000000000_r_def, 0.393649167310371_r_def, 0.393649167310371_r_def, &
                         0.050000000000000_r_def, 0.001431498841332_r_def, 0.011270166537926_r_def, &
                         0.088729833462074_r_def, 0.011270166537926_r_def, 0.011270166537926_r_def, &
                         0.088729833462074_r_def, 0.698568501158668_r_def, 0.088729833462074_r_def], &
                         [1,8,9,3] )

  end subroutine get_w0_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_w0_q3x3x3_diff_basis(diff_basis_w0)
    ! Return the diff basis function for a field on a W0 function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_w0(:,:,:,:)

    allocate(diff_basis_w0(3,8,9,3))
    diff_basis_w0 = reshape( [-0.787298334620742_r_def, -0.787298334620742_r_def, -0.787298334620742_r_def, &
                               0.787298334620742_r_def, -0.100000000000000_r_def, -0.100000000000000_r_def, &
                               0.100000000000000_r_def,  0.100000000000000_r_def, -0.012701665379258_r_def, &
                              -0.100000000000000_r_def,  0.787298334620742_r_def, -0.100000000000000_r_def, &
                              -0.100000000000000_r_def, -0.100000000000000_r_def,  0.787298334620742_r_def, &
                               0.100000000000000_r_def, -0.012701665379258_r_def,  0.100000000000000_r_def, &
                               0.012701665379258_r_def,  0.012701665379258_r_def,  0.012701665379258_r_def, &
                              -0.012701665379258_r_def,  0.100000000000000_r_def,  0.100000000000000_r_def, &
                              -0.443649167310371_r_def, -0.787298334620742_r_def, -0.443649167310371_r_def, &
                               0.443649167310371_r_def, -0.100000000000000_r_def, -0.056350832689629_r_def, &
                               0.443649167310371_r_def,  0.100000000000000_r_def, -0.056350832689629_r_def, &
                              -0.443649167310371_r_def,  0.787298334620742_r_def, -0.443649167310371_r_def, &
                              -0.056350832689629_r_def, -0.100000000000000_r_def,  0.443649167310371_r_def, &
                               0.056350832689629_r_def, -0.012701665379258_r_def,  0.056350832689629_r_def, &
                               0.056350832689629_r_def,  0.012701665379258_r_def,  0.056350832689629_r_def, &
                              -0.056350832689629_r_def,  0.100000000000000_r_def,  0.443649167310371_r_def, &
                              -0.100000000000000_r_def, -0.787298334620742_r_def, -0.100000000000000_r_def, &
                               0.100000000000000_r_def, -0.100000000000000_r_def, -0.012701665379258_r_def, &
                               0.787298334620742_r_def,  0.100000000000000_r_def, -0.100000000000000_r_def, &
                              -0.787298334620742_r_def,  0.787298334620742_r_def, -0.787298334620742_r_def, &
                              -0.012701665379258_r_def, -0.100000000000000_r_def,  0.100000000000000_r_def, &
                               0.012701665379258_r_def, -0.012701665379258_r_def,  0.012701665379258_r_def, &
                               0.100000000000000_r_def,  0.012701665379258_r_def,  0.100000000000000_r_def, &
                              -0.100000000000000_r_def,  0.100000000000000_r_def,  0.787298334620742_r_def, &
                              -0.787298334620742_r_def, -0.443649167310371_r_def, -0.443649167310371_r_def, &
                               0.787298334620742_r_def, -0.443649167310371_r_def, -0.443649167310371_r_def, &
                               0.100000000000000_r_def,  0.443649167310371_r_def, -0.056350832689629_r_def, &
                              -0.100000000000000_r_def,  0.443649167310371_r_def, -0.056350832689629_r_def, &
                              -0.100000000000000_r_def, -0.056350832689629_r_def,  0.443649167310371_r_def, &
                               0.100000000000000_r_def, -0.056350832689629_r_def,  0.443649167310371_r_def, &
                               0.012701665379258_r_def,  0.056350832689629_r_def,  0.056350832689629_r_def, &
                              -0.012701665379258_r_def,  0.056350832689629_r_def,  0.056350832689629_r_def, &
                              -0.443649167310371_r_def, -0.443649167310371_r_def, -0.250000000000000_r_def, &
                               0.443649167310371_r_def, -0.443649167310371_r_def, -0.250000000000000_r_def, &
                               0.443649167310371_r_def,  0.443649167310371_r_def, -0.250000000000000_r_def, &
                              -0.443649167310371_r_def,  0.443649167310371_r_def, -0.250000000000000_r_def, &
                              -0.056350832689629_r_def, -0.056350832689629_r_def,  0.250000000000000_r_def, &
                               0.056350832689629_r_def, -0.056350832689629_r_def,  0.250000000000000_r_def, &
                               0.056350832689629_r_def,  0.056350832689629_r_def,  0.250000000000000_r_def, &
                              -0.056350832689629_r_def,  0.056350832689629_r_def,  0.250000000000000_r_def, &
                              -0.100000000000000_r_def, -0.443649167310371_r_def, -0.056350832689629_r_def, &
                               0.100000000000000_r_def, -0.443649167310371_r_def, -0.056350832689629_r_def, &
                               0.787298334620742_r_def,  0.443649167310371_r_def, -0.443649167310371_r_def, &
                              -0.787298334620742_r_def,  0.443649167310371_r_def, -0.443649167310371_r_def, &
                              -0.012701665379258_r_def, -0.056350832689629_r_def,  0.056350832689629_r_def, &
                               0.012701665379258_r_def, -0.056350832689629_r_def,  0.056350832689629_r_def, &
                               0.100000000000000_r_def,  0.056350832689629_r_def,  0.443649167310371_r_def, &
                              -0.100000000000000_r_def,  0.056350832689629_r_def,  0.443649167310371_r_def, &
                              -0.787298334620742_r_def, -0.100000000000000_r_def, -0.100000000000000_r_def, &
                               0.787298334620742_r_def, -0.787298334620742_r_def, -0.787298334620742_r_def, &
                               0.100000000000000_r_def,  0.787298334620742_r_def, -0.100000000000000_r_def, &
                              -0.100000000000000_r_def,  0.100000000000000_r_def, -0.012701665379258_r_def, &
                              -0.100000000000000_r_def, -0.012701665379258_r_def,  0.100000000000000_r_def, &
                               0.100000000000000_r_def, -0.100000000000000_r_def,  0.787298334620742_r_def, &
                               0.012701665379258_r_def,  0.100000000000000_r_def,  0.100000000000000_r_def, &
                              -0.012701665379258_r_def,  0.012701665379258_r_def,  0.012701665379258_r_def, &
                              -0.443649167310371_r_def, -0.100000000000000_r_def, -0.056350832689629_r_def, &
                               0.443649167310371_r_def, -0.787298334620742_r_def, -0.443649167310371_r_def, &
                               0.443649167310371_r_def,  0.787298334620742_r_def, -0.443649167310371_r_def, &
                              -0.443649167310371_r_def,  0.100000000000000_r_def, -0.056350832689629_r_def, &
                              -0.056350832689629_r_def, -0.012701665379258_r_def,  0.056350832689629_r_def, &
                               0.056350832689629_r_def, -0.100000000000000_r_def,  0.443649167310371_r_def, &
                               0.056350832689629_r_def,  0.100000000000000_r_def,  0.443649167310371_r_def, &
                              -0.056350832689629_r_def,  0.012701665379258_r_def,  0.056350832689629_r_def, &
                              -0.100000000000000_r_def, -0.100000000000000_r_def, -0.012701665379258_r_def, &
                               0.100000000000000_r_def, -0.787298334620742_r_def, -0.100000000000000_r_def, &
                               0.787298334620742_r_def,  0.787298334620742_r_def, -0.787298334620742_r_def, &
                              -0.787298334620742_r_def,  0.100000000000000_r_def, -0.100000000000000_r_def, &
                              -0.012701665379258_r_def, -0.012701665379258_r_def,  0.012701665379258_r_def, &
                               0.012701665379258_r_def, -0.100000000000000_r_def,  0.100000000000000_r_def, &
                               0.100000000000000_r_def,  0.100000000000000_r_def,  0.787298334620742_r_def, &
                              -0.100000000000000_r_def,  0.012701665379258_r_def,  0.100000000000000_r_def, &
                              -0.443649167310371_r_def, -0.443649167310371_r_def, -0.787298334620742_r_def, &
                               0.443649167310371_r_def, -0.056350832689629_r_def, -0.100000000000000_r_def, &
                               0.056350832689629_r_def,  0.056350832689629_r_def, -0.012701665379258_r_def, &
                              -0.056350832689629_r_def,  0.443649167310371_r_def, -0.100000000000000_r_def, &
                              -0.443649167310371_r_def, -0.443649167310371_r_def,  0.787298334620742_r_def, &
                               0.443649167310371_r_def, -0.056350832689629_r_def,  0.100000000000000_r_def, &
                               0.056350832689629_r_def,  0.056350832689629_r_def,  0.012701665379258_r_def, &
                              -0.056350832689629_r_def,  0.443649167310371_r_def,  0.100000000000000_r_def, &
                              -0.250000000000000_r_def, -0.443649167310371_r_def, -0.443649167310371_r_def, &
                               0.250000000000000_r_def, -0.056350832689629_r_def, -0.056350832689629_r_def, &
                               0.250000000000000_r_def,  0.056350832689629_r_def, -0.056350832689629_r_def, &
                              -0.250000000000000_r_def,  0.443649167310371_r_def, -0.443649167310371_r_def, &
                              -0.250000000000000_r_def, -0.443649167310371_r_def,  0.443649167310371_r_def, &
                               0.250000000000000_r_def, -0.056350832689629_r_def,  0.056350832689629_r_def, &
                               0.250000000000000_r_def,  0.056350832689629_r_def,  0.056350832689629_r_def, &
                              -0.250000000000000_r_def,  0.443649167310371_r_def,  0.443649167310371_r_def, &
                              -0.056350832689629_r_def, -0.443649167310371_r_def, -0.100000000000000_r_def, &
                               0.056350832689629_r_def, -0.056350832689629_r_def, -0.012701665379258_r_def, &
                               0.443649167310371_r_def,  0.056350832689629_r_def, -0.100000000000000_r_def, &
                              -0.443649167310371_r_def,  0.443649167310371_r_def, -0.787298334620742_r_def, &
                              -0.056350832689629_r_def, -0.443649167310371_r_def,  0.100000000000000_r_def, &
                               0.056350832689629_r_def, -0.056350832689629_r_def,  0.012701665379258_r_def, &
                               0.443649167310371_r_def,  0.056350832689629_r_def,  0.100000000000000_r_def, &
                              -0.443649167310371_r_def,  0.443649167310371_r_def,  0.787298334620742_r_def, &
                              -0.443649167310371_r_def, -0.250000000000000_r_def, -0.443649167310371_r_def, &
                               0.443649167310371_r_def, -0.250000000000000_r_def, -0.443649167310371_r_def, &
                               0.056350832689629_r_def,  0.250000000000000_r_def, -0.056350832689629_r_def, &
                              -0.056350832689629_r_def,  0.250000000000000_r_def, -0.056350832689629_r_def, &
                              -0.443649167310371_r_def, -0.250000000000000_r_def,  0.443649167310371_r_def, &
                               0.443649167310371_r_def, -0.250000000000000_r_def,  0.443649167310371_r_def, &
                               0.056350832689629_r_def,  0.250000000000000_r_def,  0.056350832689629_r_def, &
                              -0.056350832689629_r_def,  0.250000000000000_r_def,  0.056350832689629_r_def, &
                              -0.250000000000000_r_def, -0.250000000000000_r_def, -0.250000000000000_r_def, &
                               0.250000000000000_r_def, -0.250000000000000_r_def, -0.250000000000000_r_def, &
                               0.250000000000000_r_def,  0.250000000000000_r_def, -0.250000000000000_r_def, &
                              -0.250000000000000_r_def,  0.250000000000000_r_def, -0.250000000000000_r_def, &
                              -0.250000000000000_r_def, -0.250000000000000_r_def,  0.250000000000000_r_def, &
                               0.250000000000000_r_def, -0.250000000000000_r_def,  0.250000000000000_r_def, &
                               0.250000000000000_r_def,  0.250000000000000_r_def,  0.250000000000000_r_def, &
                              -0.250000000000000_r_def,  0.250000000000000_r_def,  0.250000000000000_r_def, &
                              -0.056350832689629_r_def, -0.250000000000000_r_def, -0.056350832689629_r_def, &
                               0.056350832689629_r_def, -0.250000000000000_r_def, -0.056350832689629_r_def, &
                               0.443649167310371_r_def,  0.250000000000000_r_def, -0.443649167310371_r_def, &
                              -0.443649167310371_r_def,  0.250000000000000_r_def, -0.443649167310371_r_def, &
                              -0.056350832689629_r_def, -0.250000000000000_r_def,  0.056350832689629_r_def, &
                               0.056350832689629_r_def, -0.250000000000000_r_def,  0.056350832689629_r_def, &
                               0.443649167310371_r_def,  0.250000000000000_r_def,  0.443649167310371_r_def, &
                              -0.443649167310371_r_def,  0.250000000000000_r_def,  0.443649167310371_r_def, &
                              -0.443649167310371_r_def, -0.056350832689629_r_def, -0.100000000000000_r_def, &
                               0.443649167310371_r_def, -0.443649167310371_r_def, -0.787298334620742_r_def, &
                               0.056350832689629_r_def,  0.443649167310371_r_def, -0.100000000000000_r_def, &
                              -0.056350832689629_r_def,  0.056350832689629_r_def, -0.012701665379258_r_def, &
                              -0.443649167310371_r_def, -0.056350832689629_r_def,  0.100000000000000_r_def, &
                               0.443649167310371_r_def, -0.443649167310371_r_def,  0.787298334620742_r_def, &
                               0.056350832689629_r_def,  0.443649167310371_r_def,  0.100000000000000_r_def, &
                              -0.056350832689629_r_def,  0.056350832689629_r_def,  0.012701665379258_r_def, &
                              -0.250000000000000_r_def, -0.056350832689629_r_def, -0.056350832689629_r_def, &
                               0.250000000000000_r_def, -0.443649167310371_r_def, -0.443649167310371_r_def, &
                               0.250000000000000_r_def,  0.443649167310371_r_def, -0.443649167310371_r_def, &
                              -0.250000000000000_r_def,  0.056350832689629_r_def, -0.056350832689629_r_def, &
                              -0.250000000000000_r_def, -0.056350832689629_r_def,  0.056350832689629_r_def, &
                               0.250000000000000_r_def, -0.443649167310371_r_def,  0.443649167310371_r_def, &
                               0.250000000000000_r_def,  0.443649167310371_r_def,  0.443649167310371_r_def, &
                              -0.250000000000000_r_def,  0.056350832689629_r_def,  0.056350832689629_r_def, &
                              -0.056350832689629_r_def, -0.056350832689629_r_def, -0.012701665379258_r_def, &
                               0.056350832689629_r_def, -0.443649167310371_r_def, -0.100000000000000_r_def, &
                               0.443649167310371_r_def,  0.443649167310371_r_def, -0.787298334620742_r_def, &
                              -0.443649167310371_r_def,  0.056350832689629_r_def, -0.100000000000000_r_def, &
                              -0.056350832689629_r_def, -0.056350832689629_r_def,  0.012701665379258_r_def, &
                               0.056350832689629_r_def, -0.443649167310371_r_def,  0.100000000000000_r_def, &
                               0.443649167310371_r_def,  0.443649167310371_r_def,  0.787298334620742_r_def, &
                              -0.443649167310371_r_def,  0.056350832689629_r_def,  0.100000000000000_r_def, &
                              -0.100000000000000_r_def, -0.100000000000000_r_def, -0.787298334620742_r_def, &
                               0.100000000000000_r_def, -0.012701665379258_r_def, -0.100000000000000_r_def, &
                               0.012701665379258_r_def,  0.012701665379258_r_def, -0.012701665379258_r_def, &
                              -0.012701665379258_r_def,  0.100000000000000_r_def, -0.100000000000000_r_def, &
                              -0.787298334620742_r_def, -0.787298334620742_r_def,  0.787298334620742_r_def, &
                               0.787298334620742_r_def, -0.100000000000000_r_def,  0.100000000000000_r_def, &
                               0.100000000000000_r_def,  0.100000000000000_r_def,  0.012701665379258_r_def, &
                              -0.100000000000000_r_def,  0.787298334620742_r_def,  0.100000000000000_r_def, &
                              -0.056350832689629_r_def, -0.100000000000000_r_def, -0.443649167310371_r_def, &
                               0.056350832689629_r_def, -0.012701665379258_r_def, -0.056350832689629_r_def, &
                               0.056350832689629_r_def,  0.012701665379258_r_def, -0.056350832689629_r_def, &
                              -0.056350832689629_r_def,  0.100000000000000_r_def, -0.443649167310371_r_def, &
                              -0.443649167310371_r_def, -0.787298334620742_r_def,  0.443649167310371_r_def, &
                               0.443649167310371_r_def, -0.100000000000000_r_def,  0.056350832689629_r_def, &
                               0.443649167310371_r_def,  0.100000000000000_r_def,  0.056350832689629_r_def, &
                              -0.443649167310371_r_def,  0.787298334620742_r_def,  0.443649167310371_r_def, &
                              -0.012701665379258_r_def, -0.100000000000000_r_def, -0.100000000000000_r_def, &
                               0.012701665379258_r_def, -0.012701665379258_r_def, -0.012701665379258_r_def, &
                               0.100000000000000_r_def,  0.012701665379258_r_def, -0.100000000000000_r_def, &
                              -0.100000000000000_r_def,  0.100000000000000_r_def, -0.787298334620742_r_def, &
                              -0.100000000000000_r_def, -0.787298334620742_r_def,  0.100000000000000_r_def, &
                               0.100000000000000_r_def, -0.100000000000000_r_def,  0.012701665379258_r_def, &
                               0.787298334620742_r_def,  0.100000000000000_r_def,  0.100000000000000_r_def, &
                              -0.787298334620742_r_def,  0.787298334620742_r_def,  0.787298334620742_r_def, &
                              -0.100000000000000_r_def, -0.056350832689629_r_def, -0.443649167310371_r_def, &
                               0.100000000000000_r_def, -0.056350832689629_r_def, -0.443649167310371_r_def, &
                               0.012701665379258_r_def,  0.056350832689629_r_def, -0.056350832689629_r_def, &
                              -0.012701665379258_r_def,  0.056350832689629_r_def, -0.056350832689629_r_def, &
                              -0.787298334620742_r_def, -0.443649167310371_r_def,  0.443649167310371_r_def, &
                               0.787298334620742_r_def, -0.443649167310371_r_def,  0.443649167310371_r_def, &
                               0.100000000000000_r_def,  0.443649167310371_r_def,  0.056350832689629_r_def, &
                              -0.100000000000000_r_def,  0.443649167310371_r_def,  0.056350832689629_r_def, &
                              -0.056350832689629_r_def, -0.056350832689629_r_def, -0.250000000000000_r_def, &
                               0.056350832689629_r_def, -0.056350832689629_r_def, -0.250000000000000_r_def, &
                               0.056350832689629_r_def,  0.056350832689629_r_def, -0.250000000000000_r_def, &
                              -0.056350832689629_r_def,  0.056350832689629_r_def, -0.250000000000000_r_def, &
                              -0.443649167310371_r_def, -0.443649167310371_r_def,  0.250000000000000_r_def, &
                               0.443649167310371_r_def, -0.443649167310371_r_def,  0.250000000000000_r_def, &
                               0.443649167310371_r_def,  0.443649167310371_r_def,  0.250000000000000_r_def, &
                              -0.443649167310371_r_def,  0.443649167310371_r_def,  0.250000000000000_r_def, &
                              -0.012701665379258_r_def, -0.056350832689629_r_def, -0.056350832689629_r_def, &
                               0.012701665379258_r_def, -0.056350832689629_r_def, -0.056350832689629_r_def, &
                               0.100000000000000_r_def,  0.056350832689629_r_def, -0.443649167310371_r_def, &
                              -0.100000000000000_r_def,  0.056350832689629_r_def, -0.443649167310371_r_def, &
                              -0.100000000000000_r_def, -0.443649167310371_r_def,  0.056350832689629_r_def, &
                               0.100000000000000_r_def, -0.443649167310371_r_def,  0.056350832689629_r_def, &
                               0.787298334620742_r_def,  0.443649167310371_r_def,  0.443649167310371_r_def, &
                              -0.787298334620742_r_def,  0.443649167310371_r_def,  0.443649167310371_r_def, &
                              -0.100000000000000_r_def, -0.012701665379258_r_def, -0.100000000000000_r_def, &
                               0.100000000000000_r_def, -0.100000000000000_r_def, -0.787298334620742_r_def, &
                               0.012701665379258_r_def,  0.100000000000000_r_def, -0.100000000000000_r_def, &
                              -0.012701665379258_r_def,  0.012701665379258_r_def, -0.012701665379258_r_def, &
                              -0.787298334620742_r_def, -0.100000000000000_r_def,  0.100000000000000_r_def, &
                               0.787298334620742_r_def, -0.787298334620742_r_def,  0.787298334620742_r_def, &
                               0.100000000000000_r_def,  0.787298334620742_r_def,  0.100000000000000_r_def, &
                              -0.100000000000000_r_def,  0.100000000000000_r_def,  0.012701665379258_r_def, &
                              -0.056350832689629_r_def, -0.012701665379258_r_def, -0.056350832689629_r_def, &
                               0.056350832689629_r_def, -0.100000000000000_r_def, -0.443649167310371_r_def, &
                               0.056350832689629_r_def,  0.100000000000000_r_def, -0.443649167310371_r_def, &
                              -0.056350832689629_r_def,  0.012701665379258_r_def, -0.056350832689629_r_def, &
                              -0.443649167310371_r_def, -0.100000000000000_r_def,  0.056350832689629_r_def, &
                               0.443649167310371_r_def, -0.787298334620742_r_def,  0.443649167310371_r_def, &
                               0.443649167310371_r_def,  0.787298334620742_r_def,  0.443649167310371_r_def, &
                              -0.443649167310371_r_def,  0.100000000000000_r_def,  0.056350832689629_r_def, &
                              -0.012701665379258_r_def, -0.012701665379258_r_def, -0.012701665379258_r_def, &
                               0.012701665379258_r_def, -0.100000000000000_r_def, -0.100000000000000_r_def, &
                               0.100000000000000_r_def,  0.100000000000000_r_def, -0.787298334620742_r_def, &
                              -0.100000000000000_r_def,  0.012701665379258_r_def, -0.100000000000000_r_def, &
                              -0.100000000000000_r_def, -0.100000000000000_r_def,  0.012701665379258_r_def, &
                               0.100000000000000_r_def, -0.787298334620742_r_def,  0.100000000000000_r_def, &
                               0.787298334620742_r_def,  0.787298334620742_r_def,  0.787298334620742_r_def, &
                              -0.787298334620742_r_def,  0.100000000000000_r_def,  0.100000000000000_r_def], &
                              [3,8,9,3] )

  end subroutine get_w0_q3x3x3_diff_basis

!---------------------------------------------------------------------

  subroutine get_w1_q3x3x3_basis(basis_w1)
    ! Return the basis function for a field on a W1 function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_w1(:,:,:,:)

    allocate(basis_w1(3,12,9,3))
    basis_w1(:,:,:,1) = reshape( [0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def], [3,12,9] )
    basis_w1(:,:,:,2) = reshape( [0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.250000000000000_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.250000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def], [3,12,9] )
    basis_w1(:,:,:,3) = reshape( [0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.250000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.056350832689629_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.443649167310371_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.056350832689629_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.443649167310371_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.056350832689629_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.443649167310371_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.012701665379258_r_def, 0.000000000000000_r_def, &
                                  0.012701665379258_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.012701665379258_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.787298334620742_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, 0.100000000000000_r_def, &
                                  0.000000000000000_r_def, 0.100000000000000_r_def, 0.000000000000000_r_def, &
                                  0.100000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.787298334620742_r_def, 0.000000000000000_r_def, &
                                  0.787298334620742_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def], [3,12,9] )

  end subroutine get_w1_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_w1_q3x3x3_diff_basis(diff_basis_w1)
    ! Return the diff basis function for a field on a W1 function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_w1(:,:,:,:)

    allocate(diff_basis_w1(3,12,9,3))
    diff_basis_w1(:,:,:,1) = reshape( [ 0.887298334620742_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.887298334620742_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.887298334620742_r_def, &
                                       -0.887298334620742_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.112701665379258_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.112701665379258_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.887298334620742_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.887298334620742_r_def, &
                                       -0.887298334620742_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.112701665379258_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.112701665379258_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.887298334620742_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.887298334620742_r_def, &
                                       -0.887298334620742_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.112701665379258_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.112701665379258_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.887298334620742_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.887298334620742_r_def, &
                                       -0.500000000000000_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.112701665379258_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.112701665379258_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.887298334620742_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.887298334620742_r_def, &
                                       -0.500000000000000_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.112701665379258_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.112701665379258_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.887298334620742_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.887298334620742_r_def, &
                                       -0.500000000000000_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.112701665379258_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.112701665379258_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.887298334620742_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.887298334620742_r_def, &
                                       -0.112701665379258_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.112701665379258_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.112701665379258_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.887298334620742_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.887298334620742_r_def, &
                                       -0.112701665379258_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.112701665379258_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.112701665379258_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.887298334620742_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.887298334620742_r_def, &
                                       -0.112701665379258_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.112701665379258_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.112701665379258_r_def], [3,12,9] )
    diff_basis_w1(:,:,:,2) = reshape( [ 0.887298334620742_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.500000000000000_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.500000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.500000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.500000000000000_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.500000000000000_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.500000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.500000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.500000000000000_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.500000000000000_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.500000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.500000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.500000000000000_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.500000000000000_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.500000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.500000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.500000000000000_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.500000000000000_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.500000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.500000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.500000000000000_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.500000000000000_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.500000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.500000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.500000000000000_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.500000000000000_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.500000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.500000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.500000000000000_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.500000000000000_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.500000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.500000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.500000000000000_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.500000000000000_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.500000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.500000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.500000000000000_r_def], [3,12,9] )
    diff_basis_w1(:,:,:,3) = reshape( [ 0.887298334620742_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.112701665379258_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.112701665379258_r_def, &
                                       -0.887298334620742_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.887298334620742_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.887298334620742_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.112701665379258_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.112701665379258_r_def, &
                                       -0.887298334620742_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.887298334620742_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.887298334620742_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.112701665379258_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.112701665379258_r_def, &
                                       -0.887298334620742_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.887298334620742_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.887298334620742_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.112701665379258_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.112701665379258_r_def, &
                                       -0.500000000000000_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.887298334620742_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.887298334620742_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.112701665379258_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.112701665379258_r_def, &
                                       -0.500000000000000_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.887298334620742_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.887298334620742_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.112701665379258_r_def, &
                                        0.500000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.112701665379258_r_def, &
                                       -0.500000000000000_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.500000000000000_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.887298334620742_r_def, &
                                       -0.500000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.887298334620742_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def,  0.112701665379258_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def, -0.112701665379258_r_def, &
                                       -0.112701665379258_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def,  0.887298334620742_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def, -0.887298334620742_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def,  0.112701665379258_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.500000000000000_r_def, -0.112701665379258_r_def, &
                                       -0.112701665379258_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.500000000000000_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def,  0.887298334620742_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.500000000000000_r_def, -0.887298334620742_r_def, &
                                        0.112701665379258_r_def,  0.000000000000000_r_def, -0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.112701665379258_r_def,  0.112701665379258_r_def, &
                                        0.887298334620742_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                                        0.000000000000000_r_def, -0.887298334620742_r_def, -0.112701665379258_r_def, &
                                       -0.112701665379258_r_def,  0.112701665379258_r_def,  0.000000000000000_r_def, &
                                       -0.887298334620742_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                                        0.887298334620742_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                                        0.112701665379258_r_def,  0.887298334620742_r_def,  0.000000000000000_r_def, &
                                       -0.112701665379258_r_def,  0.000000000000000_r_def, -0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.112701665379258_r_def,  0.887298334620742_r_def, &
                                       -0.887298334620742_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                                        0.000000000000000_r_def,  0.887298334620742_r_def, -0.887298334620742_r_def], [3,12,9] )

  end subroutine get_w1_q3x3x3_diff_basis

!---------------------------------------------------------------------

  subroutine get_w2_q3x3x3_basis(basis_w2)
    ! Return the basis function for a field on a W2 function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_w2(:,:,:,:)

    allocate(basis_w2(3,6,9,3))
    basis_w2 = reshape( [0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.500000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def, &
                         0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                         0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.112701665379258_r_def, &
                         0.000000000000000_r_def,  0.000000000000000_r_def,  0.887298334620742_r_def], &
                         [3,6,9,3] )

  end subroutine get_w2_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_w2_q3x3x3_diff_basis(diff_basis_w2)
    ! Return the diff basis function for a field on a W2 function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_w2(:,:,:,:)

    allocate(diff_basis_w2(1,6,9,3))
    diff_basis_w2 = reshape( [-1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                              -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def], &
                              [1,6,9,3] )


  end subroutine get_w2_q3x3x3_diff_basis

!---------------------------------------------------------------------

  subroutine get_w2v_q3x3x3_basis(basis_w2v)
    ! Return the basis function for a field on a W2V function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_w2v(:,:,:,:)

    allocate(basis_w2v(3,2,9,3))
    basis_w2v = reshape( [0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.500000000000000_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.112701665379258_r_def, &
                          0.000000000000000_r_def, 0.000000000000000_r_def, 0.887298334620742_r_def], &
                          [3,2,9,3] )

  end subroutine get_w2v_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_w2v_q3x3x3_diff_basis(diff_basis_w2v)
    ! Return the diff basis function for a field on a W2V function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_w2v(:,:,:,:)

    allocate(diff_basis_w2v(1,2,9,3))
    diff_basis_w2v = reshape( [-1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def], &
                               [1,2,9,3] )

  end subroutine get_w2v_q3x3x3_diff_basis

!---------------------------------------------------------------------

  subroutine get_w2h_q3x3x3_basis(basis_w2h)
    ! Return the basis function for a field on a W2H function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_w2h(:,:,:,:)

    allocate(basis_w2h(3,4,9,3))
    basis_w2h = reshape( [0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.500000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.500000000000000_r_def,  0.000000000000000_r_def, &
                          0.112701665379258_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.112701665379258_r_def,  0.000000000000000_r_def, &
                          0.887298334620742_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                          0.000000000000000_r_def, -0.887298334620742_r_def,  0.000000000000000_r_def], &
                          [3,4,9,3] )

  end subroutine get_w2h_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_w2h_q3x3x3_diff_basis(diff_basis_w2h)
    ! Return the diff basis function for a field on a W2H function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_w2h(:,:,:,:)

    allocate(diff_basis_w2h(1,4,9,3))
    diff_basis_w2h = reshape( [-1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def, &
                               -1.000000000000000_r_def,  1.000000000000000_r_def,  1.000000000000000_r_def, &
                               -1.000000000000000_r_def, -1.000000000000000_r_def,  1.000000000000000_r_def, &
                                1.000000000000000_r_def, -1.000000000000000_r_def, -1.000000000000000_r_def, &
                                1.000000000000000_r_def,  1.000000000000000_r_def, -1.000000000000000_r_def], &
                              [1,4,9,3] )

  end subroutine get_w2h_q3x3x3_diff_basis

!---------------------------------------------------------------------

  subroutine get_w2broken_q3x3x3_basis(basis_w2broken)
    ! Return the basis function for a field on a W2broken function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_w2broken(:,:,:,:)

    ! W2broken has the same basis functions as w2, so use those
    call get_w2_q3x3x3_basis(basis_w2broken)

  end subroutine get_w2broken_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_w2broken_q3x3x3_diff_basis(diff_basis_w2broken)
    ! Return the diff basis function for a field on a W2broken function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_w2broken(:,:,:,:)

    ! W2broken has the same differential basis functions as w2, so use those
    call get_w2_q3x3x3_diff_basis(diff_basis_w2broken)

  end subroutine get_w2broken_q3x3x3_diff_basis

!---------------------------------------------------------------------

  subroutine get_w2trace_q3x3x3_basis(basis_w2trace)
    ! Return the basis function for a field on a W2trace function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_w2trace(:,:,:,:)

    allocate(basis_w2trace(1,6,9,3))
    basis_w2trace = reshape( [0.887298334620742_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.887298334620742_r_def, 0.500000000000000_r_def, 0.112701665379258_r_def, &
                              0.500000000000000_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.887298334620742_r_def, 0.112701665379258_r_def, 0.112701665379258_r_def, &
                              0.887298334620742_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.500000000000000_r_def, 0.887298334620742_r_def, 0.500000000000000_r_def, &
                              0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.500000000000000_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.500000000000000_r_def, 0.112701665379258_r_def, 0.500000000000000_r_def, &
                              0.887298334620742_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.112701665379258_r_def, 0.887298334620742_r_def, 0.887298334620742_r_def, &
                              0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.112701665379258_r_def, 0.500000000000000_r_def, 0.887298334620742_r_def, &
                              0.500000000000000_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.112701665379258_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.887298334620742_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.887298334620742_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.112701665379258_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.887298334620742_r_def, 0.500000000000000_r_def, 0.112701665379258_r_def, &
                              0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.887298334620742_r_def, 0.112701665379258_r_def, 0.112701665379258_r_def, &
                              0.887298334620742_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.500000000000000_r_def, 0.887298334620742_r_def, 0.500000000000000_r_def, &
                              0.112701665379258_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.500000000000000_r_def, 0.112701665379258_r_def, 0.500000000000000_r_def, &
                              0.887298334620742_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.112701665379258_r_def, 0.887298334620742_r_def, 0.887298334620742_r_def, &
                              0.112701665379258_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.112701665379258_r_def, 0.500000000000000_r_def, 0.887298334620742_r_def, &
                              0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.112701665379258_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.887298334620742_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.887298334620742_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                              0.112701665379258_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.887298334620742_r_def, 0.500000000000000_r_def, 0.112701665379258_r_def, &
                              0.500000000000000_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.887298334620742_r_def, 0.112701665379258_r_def, 0.112701665379258_r_def, &
                              0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.500000000000000_r_def, 0.887298334620742_r_def, 0.500000000000000_r_def, &
                              0.112701665379258_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                              0.500000000000000_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.500000000000000_r_def, 0.112701665379258_r_def, 0.500000000000000_r_def, &
                              0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.112701665379258_r_def, 0.887298334620742_r_def, 0.887298334620742_r_def, &
                              0.112701665379258_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.112701665379258_r_def, 0.500000000000000_r_def, 0.887298334620742_r_def, &
                              0.500000000000000_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.112701665379258_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                              0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def], &
                              [1,6,9,3] )

  end subroutine get_w2trace_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_w2trace_q3x3x3_diff_basis(diff_basis_w2trace)
    ! Return the diff basis function for a field on a W2trace function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_w2trace(:,:,:,:)

    allocate(diff_basis_w2trace(3,6,9,3))
    diff_basis_w2trace = reshape( [-1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def, &
                                   -1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def, -1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    1.000000000000000_r_def,  0.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  1.000000000000000_r_def,  0.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def, -1.000000000000000_r_def, &
                                    0.000000000000000_r_def,  0.000000000000000_r_def,  1.000000000000000_r_def], &
                                    [3,6,9,3] )

  end subroutine get_w2trace_q3x3x3_diff_basis

!---------------------------------------------------------------------

  subroutine get_w3_q3x3x3_basis(basis_w3)
    ! Return the basis function for a field on a W3 function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_w3(:,:,:,:)

    allocate(basis_w3(1,1,9,3))
    basis_w3 = reshape( [1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def, &
                         1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def, &
                         1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def, &
                         1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def, &
                         1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def, &
                         1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def, &
                         1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def, &
                         1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def, &
                         1.000000000000000_r_def,1.000000000000000_r_def,1.000000000000000_r_def], &
                         [1,1,9,3] )

  end subroutine get_w3_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_w3_q3x3x3_diff_basis(diff_basis_w3)
    ! Return the diff basis function for a field on a W3 function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_w3(:,:,:,:)

    allocate(diff_basis_w3(3,1,9,3))
    diff_basis_w3 = reshape( [0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def,  &
                              0.000000000000000_r_def, 0.000000000000000_r_def, 0.000000000000000_r_def], &
                              [3,1,9,3] )

  end subroutine get_w3_q3x3x3_diff_basis

!---------------------------------------------------------------------

  subroutine get_wtheta_q3x3x3_basis(basis_wtheta)
    ! Return the basis function for a field on a Wtheta function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_wtheta(:,:,:,:)

    allocate(basis_wtheta(1,2,9,3))
    basis_wtheta = reshape( [0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                             0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                             0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                             0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                             0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                             0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                             0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                             0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                             0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                             0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                             0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                             0.500000000000000_r_def, 0.500000000000000_r_def, 0.500000000000000_r_def, &
                             0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                             0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                             0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                             0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def, &
                             0.112701665379258_r_def, 0.887298334620742_r_def, 0.112701665379258_r_def, &
                             0.887298334620742_r_def, 0.112701665379258_r_def, 0.887298334620742_r_def], &
                             [1,2,9,3] )

  end subroutine get_wtheta_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_wtheta_q3x3x3_diff_basis(diff_basis_wtheta)
    ! Return the diff basis function for a field on a Wtheta function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_wtheta(:,:,:,:)

    allocate(diff_basis_wtheta(3,2,9,3))
    diff_basis_wtheta = reshape( [0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def, -1.000000000000000_r_def, &
                                  0.000000000000000_r_def, 0.000000000000000_r_def,  1.000000000000000_r_def], &
                                  [3,2,9,3] )

  end subroutine get_wtheta_q3x3x3_diff_basis

!---------------------------------------------------------------------


  subroutine get_wchi_q3x3x3_basis(basis_wchi)
    ! Return the basis function for a field on a Wchi function space
    implicit none
    real(r_def), allocatable, intent(out) :: basis_wchi(:,:,:,:)

    allocate(basis_wchi(1,8,9,3))
    basis_wchi = reshape( [0.698568501158668_r_def, 0.088729833462074_r_def, 0.088729833462074_r_def, &
                           0.011270166537926_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                           0.011270166537926_r_def, 0.001431498841332_r_def, 0.393649167310371_r_def, &
                           0.050000000000000_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                           0.050000000000000_r_def, 0.006350832689629_r_def, 0.050000000000000_r_def, &
                           0.006350832689629_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                           0.698568501158668_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                           0.001431498841332_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                           0.393649167310371_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                           0.050000000000000_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                           0.006350832689629_r_def, 0.006350832689629_r_def, 0.221824583655185_r_def, &
                           0.221824583655185_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                           0.028175416344815_r_def, 0.028175416344815_r_def, 0.028175416344815_r_def, &
                           0.028175416344815_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                           0.393649167310371_r_def, 0.393649167310371_r_def, 0.006350832689629_r_def, &
                           0.006350832689629_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                           0.088729833462074_r_def, 0.698568501158668_r_def, 0.011270166537926_r_def, &
                           0.088729833462074_r_def, 0.011270166537926_r_def, 0.088729833462074_r_def, &
                           0.001431498841332_r_def, 0.011270166537926_r_def, 0.050000000000000_r_def, &
                           0.393649167310371_r_def, 0.050000000000000_r_def, 0.393649167310371_r_def, &
                           0.006350832689629_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                           0.050000000000000_r_def, 0.011270166537926_r_def, 0.088729833462074_r_def, &
                           0.088729833462074_r_def, 0.698568501158668_r_def, 0.001431498841332_r_def, &
                           0.011270166537926_r_def, 0.011270166537926_r_def, 0.088729833462074_r_def, &
                           0.393649167310371_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                           0.006350832689629_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                           0.050000000000000_r_def, 0.006350832689629_r_def, 0.221824583655185_r_def, &
                           0.028175416344815_r_def, 0.221824583655185_r_def, 0.028175416344815_r_def, &
                           0.221824583655185_r_def, 0.028175416344815_r_def, 0.221824583655185_r_def, &
                           0.028175416344815_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                           0.393649167310371_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                           0.006350832689629_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                           0.221824583655185_r_def, 0.221824583655185_r_def, 0.028175416344815_r_def, &
                           0.028175416344815_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                           0.028175416344815_r_def, 0.028175416344815_r_def, 0.125000000000000_r_def, &
                           0.125000000000000_r_def, 0.125000000000000_r_def, 0.125000000000000_r_def, &
                           0.125000000000000_r_def, 0.125000000000000_r_def, 0.125000000000000_r_def, &
                           0.125000000000000_r_def, 0.028175416344815_r_def, 0.028175416344815_r_def, &
                           0.221824583655185_r_def, 0.221824583655185_r_def, 0.028175416344815_r_def, &
                           0.028175416344815_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                           0.050000000000000_r_def, 0.393649167310371_r_def, 0.006350832689629_r_def, &
                           0.050000000000000_r_def, 0.050000000000000_r_def, 0.393649167310371_r_def, &
                           0.006350832689629_r_def, 0.050000000000000_r_def, 0.028175416344815_r_def, &
                           0.221824583655185_r_def, 0.028175416344815_r_def, 0.221824583655185_r_def, &
                           0.028175416344815_r_def, 0.221824583655185_r_def, 0.028175416344815_r_def, &
                           0.221824583655185_r_def, 0.006350832689629_r_def, 0.050000000000000_r_def, &
                           0.050000000000000_r_def, 0.393649167310371_r_def, 0.006350832689629_r_def, &
                           0.050000000000000_r_def, 0.050000000000000_r_def, 0.393649167310371_r_def, &
                           0.088729833462074_r_def, 0.011270166537926_r_def, 0.011270166537926_r_def, &
                           0.001431498841332_r_def, 0.698568501158668_r_def, 0.088729833462074_r_def, &
                           0.088729833462074_r_def, 0.011270166537926_r_def, 0.050000000000000_r_def, &
                           0.006350832689629_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                           0.393649167310371_r_def, 0.050000000000000_r_def, 0.393649167310371_r_def, &
                           0.050000000000000_r_def, 0.011270166537926_r_def, 0.001431498841332_r_def, &
                           0.088729833462074_r_def, 0.011270166537926_r_def, 0.088729833462074_r_def, &
                           0.011270166537926_r_def, 0.698568501158668_r_def, 0.088729833462074_r_def, &
                           0.050000000000000_r_def, 0.050000000000000_r_def, 0.006350832689629_r_def, &
                           0.006350832689629_r_def, 0.393649167310371_r_def, 0.393649167310371_r_def, &
                           0.050000000000000_r_def, 0.050000000000000_r_def, 0.028175416344815_r_def, &
                           0.028175416344815_r_def, 0.028175416344815_r_def, 0.028175416344815_r_def, &
                           0.221824583655185_r_def, 0.221824583655185_r_def, 0.221824583655185_r_def, &
                           0.221824583655185_r_def, 0.006350832689629_r_def, 0.006350832689629_r_def, &
                           0.050000000000000_r_def, 0.050000000000000_r_def, 0.050000000000000_r_def, &
                           0.050000000000000_r_def, 0.393649167310371_r_def, 0.393649167310371_r_def, &
                           0.011270166537926_r_def, 0.088729833462074_r_def, 0.001431498841332_r_def, &
                           0.011270166537926_r_def, 0.088729833462074_r_def, 0.698568501158668_r_def, &
                           0.011270166537926_r_def, 0.088729833462074_r_def, 0.006350832689629_r_def, &
                           0.050000000000000_r_def, 0.006350832689629_r_def, 0.050000000000000_r_def, &
                           0.050000000000000_r_def, 0.393649167310371_r_def, 0.050000000000000_r_def, &
                           0.393649167310371_r_def, 0.001431498841332_r_def, 0.011270166537926_r_def, &
                           0.011270166537926_r_def, 0.088729833462074_r_def, 0.011270166537926_r_def, &
                           0.088729833462074_r_def, 0.088729833462074_r_def, 0.698568501158668_r_def], &
                           [1,8,9,3] )

  end subroutine get_wchi_q3x3x3_basis

!---------------------------------------------------------------------

  subroutine get_wchi_q3x3x3_diff_basis(diff_basis_wchi)
    ! Return the diff basis function for a field on a Wchi function space
    implicit none
    real(r_def), allocatable, intent(out) :: diff_basis_wchi(:,:,:,:)

    allocate(diff_basis_wchi(3,8,9,3))
    diff_basis_wchi = reshape( [-0.787298334620742_r_def, -0.787298334620742_r_def, -0.787298334620742_r_def, &
                                 0.787298334620742_r_def, -0.100000000000000_r_def, -0.100000000000000_r_def, &
                                -0.100000000000000_r_def,  0.787298334620742_r_def, -0.100000000000000_r_def, &
                                 0.100000000000000_r_def,  0.100000000000000_r_def, -0.012701665379258_r_def, &
                                -0.100000000000000_r_def, -0.100000000000000_r_def,  0.787298334620742_r_def, &
                                 0.100000000000000_r_def, -0.012701665379258_r_def,  0.100000000000000_r_def, &
                                -0.012701665379258_r_def,  0.100000000000000_r_def,  0.100000000000000_r_def, &
                                 0.012701665379258_r_def,  0.012701665379258_r_def,  0.012701665379258_r_def, &
                                -0.443649167310371_r_def, -0.787298334620742_r_def, -0.443649167310371_r_def, &
                                 0.443649167310371_r_def, -0.100000000000000_r_def, -0.056350832689629_r_def, &
                                -0.443649167310371_r_def,  0.787298334620742_r_def, -0.443649167310371_r_def, &
                                 0.443649167310371_r_def,  0.100000000000000_r_def, -0.056350832689629_r_def, &
                                -0.056350832689629_r_def, -0.100000000000000_r_def,  0.443649167310371_r_def, &
                                 0.056350832689629_r_def, -0.012701665379258_r_def,  0.056350832689629_r_def, &
                                -0.056350832689629_r_def,  0.100000000000000_r_def,  0.443649167310371_r_def, &
                                 0.056350832689629_r_def,  0.012701665379258_r_def,  0.056350832689629_r_def, &
                                -0.100000000000000_r_def, -0.787298334620742_r_def, -0.100000000000000_r_def, &
                                 0.100000000000000_r_def, -0.100000000000000_r_def, -0.012701665379258_r_def, &
                                -0.787298334620742_r_def,  0.787298334620742_r_def, -0.787298334620742_r_def, &
                                 0.787298334620742_r_def,  0.100000000000000_r_def, -0.100000000000000_r_def, &
                                -0.012701665379258_r_def, -0.100000000000000_r_def,  0.100000000000000_r_def, &
                                 0.012701665379258_r_def, -0.012701665379258_r_def,  0.012701665379258_r_def, &
                                -0.100000000000000_r_def,  0.100000000000000_r_def,  0.787298334620742_r_def, &
                                 0.100000000000000_r_def,  0.012701665379258_r_def,  0.100000000000000_r_def, &
                                -0.787298334620742_r_def, -0.443649167310371_r_def, -0.443649167310371_r_def, &
                                 0.787298334620742_r_def, -0.443649167310371_r_def, -0.443649167310371_r_def, &
                                -0.100000000000000_r_def,  0.443649167310371_r_def, -0.056350832689629_r_def, &
                                 0.100000000000000_r_def,  0.443649167310371_r_def, -0.056350832689629_r_def, &
                                -0.100000000000000_r_def, -0.056350832689629_r_def,  0.443649167310371_r_def, &
                                 0.100000000000000_r_def, -0.056350832689629_r_def,  0.443649167310371_r_def, &
                                -0.012701665379258_r_def,  0.056350832689629_r_def,  0.056350832689629_r_def, &
                                 0.012701665379258_r_def,  0.056350832689629_r_def,  0.056350832689629_r_def, &
                                -0.443649167310371_r_def, -0.443649167310371_r_def, -0.250000000000000_r_def, &
                                 0.443649167310371_r_def, -0.443649167310371_r_def, -0.250000000000000_r_def, &
                                -0.443649167310371_r_def,  0.443649167310371_r_def, -0.250000000000000_r_def, &
                                 0.443649167310371_r_def,  0.443649167310371_r_def, -0.250000000000000_r_def, &
                                -0.056350832689629_r_def, -0.056350832689629_r_def,  0.250000000000000_r_def, &
                                 0.056350832689629_r_def, -0.056350832689629_r_def,  0.250000000000000_r_def, &
                                -0.056350832689629_r_def,  0.056350832689629_r_def,  0.250000000000000_r_def, &
                                 0.056350832689629_r_def,  0.056350832689629_r_def,  0.250000000000000_r_def, &
                                -0.100000000000000_r_def, -0.443649167310371_r_def, -0.056350832689629_r_def, &
                                 0.100000000000000_r_def, -0.443649167310371_r_def, -0.056350832689629_r_def, &
                                -0.787298334620742_r_def,  0.443649167310371_r_def, -0.443649167310371_r_def, &
                                 0.787298334620742_r_def,  0.443649167310371_r_def, -0.443649167310371_r_def, &
                                -0.012701665379258_r_def, -0.056350832689629_r_def,  0.056350832689629_r_def, &
                                 0.012701665379258_r_def, -0.056350832689629_r_def,  0.056350832689629_r_def, &
                                -0.100000000000000_r_def,  0.056350832689629_r_def,  0.443649167310371_r_def, &
                                 0.100000000000000_r_def,  0.056350832689629_r_def,  0.443649167310371_r_def, &
                                -0.787298334620742_r_def, -0.100000000000000_r_def, -0.100000000000000_r_def, &
                                 0.787298334620742_r_def, -0.787298334620742_r_def, -0.787298334620742_r_def, &
                                -0.100000000000000_r_def,  0.100000000000000_r_def, -0.012701665379258_r_def, &
                                 0.100000000000000_r_def,  0.787298334620742_r_def, -0.100000000000000_r_def, &
                                -0.100000000000000_r_def, -0.012701665379258_r_def,  0.100000000000000_r_def, &
                                 0.100000000000000_r_def, -0.100000000000000_r_def,  0.787298334620742_r_def, &
                                -0.012701665379258_r_def,  0.012701665379258_r_def,  0.012701665379258_r_def, &
                                 0.012701665379258_r_def,  0.100000000000000_r_def,  0.100000000000000_r_def, &
                                -0.443649167310371_r_def, -0.100000000000000_r_def, -0.056350832689629_r_def, &
                                 0.443649167310371_r_def, -0.787298334620742_r_def, -0.443649167310371_r_def, &
                                -0.443649167310371_r_def,  0.100000000000000_r_def, -0.056350832689629_r_def, &
                                 0.443649167310371_r_def,  0.787298334620742_r_def, -0.443649167310371_r_def, &
                                -0.056350832689629_r_def, -0.012701665379258_r_def,  0.056350832689629_r_def, &
                                 0.056350832689629_r_def, -0.100000000000000_r_def,  0.443649167310371_r_def, &
                                -0.056350832689629_r_def,  0.012701665379258_r_def,  0.056350832689629_r_def, &
                                 0.056350832689629_r_def,  0.100000000000000_r_def,  0.443649167310371_r_def, &
                                -0.100000000000000_r_def, -0.100000000000000_r_def, -0.012701665379258_r_def, &
                                 0.100000000000000_r_def, -0.787298334620742_r_def, -0.100000000000000_r_def, &
                                -0.787298334620742_r_def,  0.100000000000000_r_def, -0.100000000000000_r_def, &
                                 0.787298334620742_r_def,  0.787298334620742_r_def, -0.787298334620742_r_def, &
                                -0.012701665379258_r_def, -0.012701665379258_r_def,  0.012701665379258_r_def, &
                                 0.012701665379258_r_def, -0.100000000000000_r_def,  0.100000000000000_r_def, &
                                -0.100000000000000_r_def,  0.012701665379258_r_def,  0.100000000000000_r_def, &
                                 0.100000000000000_r_def,  0.100000000000000_r_def,  0.787298334620742_r_def, &
                                -0.443649167310371_r_def, -0.443649167310371_r_def, -0.787298334620742_r_def, &
                                 0.443649167310371_r_def, -0.056350832689629_r_def, -0.100000000000000_r_def, &
                                -0.056350832689629_r_def,  0.443649167310371_r_def, -0.100000000000000_r_def, &
                                 0.056350832689629_r_def,  0.056350832689629_r_def, -0.012701665379258_r_def, &
                                -0.443649167310371_r_def, -0.443649167310371_r_def,  0.787298334620742_r_def, &
                                 0.443649167310371_r_def, -0.056350832689629_r_def,  0.100000000000000_r_def, &
                                -0.056350832689629_r_def,  0.443649167310371_r_def,  0.100000000000000_r_def, &
                                 0.056350832689629_r_def,  0.056350832689629_r_def,  0.012701665379258_r_def, &
                                -0.250000000000000_r_def, -0.443649167310371_r_def, -0.443649167310371_r_def, &
                                 0.250000000000000_r_def, -0.056350832689629_r_def, -0.056350832689629_r_def, &
                                -0.250000000000000_r_def,  0.443649167310371_r_def, -0.443649167310371_r_def, &
                                 0.250000000000000_r_def,  0.056350832689629_r_def, -0.056350832689629_r_def, &
                                -0.250000000000000_r_def, -0.443649167310371_r_def,  0.443649167310371_r_def, &
                                 0.250000000000000_r_def, -0.056350832689629_r_def,  0.056350832689629_r_def, &
                                -0.250000000000000_r_def,  0.443649167310371_r_def,  0.443649167310371_r_def, &
                                 0.250000000000000_r_def,  0.056350832689629_r_def,  0.056350832689629_r_def, &
                                -0.056350832689629_r_def, -0.443649167310371_r_def, -0.100000000000000_r_def, &
                                 0.056350832689629_r_def, -0.056350832689629_r_def, -0.012701665379258_r_def, &
                                -0.443649167310371_r_def,  0.443649167310371_r_def, -0.787298334620742_r_def, &
                                 0.443649167310371_r_def,  0.056350832689629_r_def, -0.100000000000000_r_def, &
                                -0.056350832689629_r_def, -0.443649167310371_r_def,  0.100000000000000_r_def, &
                                 0.056350832689629_r_def, -0.056350832689629_r_def,  0.012701665379258_r_def, &
                                -0.443649167310371_r_def,  0.443649167310371_r_def,  0.787298334620742_r_def, &
                                 0.443649167310371_r_def,  0.056350832689629_r_def,  0.100000000000000_r_def, &
                                -0.443649167310371_r_def, -0.250000000000000_r_def, -0.443649167310371_r_def, &
                                 0.443649167310371_r_def, -0.250000000000000_r_def, -0.443649167310371_r_def, &
                                -0.056350832689629_r_def,  0.250000000000000_r_def, -0.056350832689629_r_def, &
                                 0.056350832689629_r_def,  0.250000000000000_r_def, -0.056350832689629_r_def, &
                                -0.443649167310371_r_def, -0.250000000000000_r_def,  0.443649167310371_r_def, &
                                 0.443649167310371_r_def, -0.250000000000000_r_def,  0.443649167310371_r_def, &
                                -0.056350832689629_r_def,  0.250000000000000_r_def,  0.056350832689629_r_def, &
                                 0.056350832689629_r_def,  0.250000000000000_r_def,  0.056350832689629_r_def, &
                                -0.250000000000000_r_def, -0.250000000000000_r_def, -0.250000000000000_r_def, &
                                 0.250000000000000_r_def, -0.250000000000000_r_def, -0.250000000000000_r_def, &
                                -0.250000000000000_r_def,  0.250000000000000_r_def, -0.250000000000000_r_def, &
                                 0.250000000000000_r_def,  0.250000000000000_r_def, -0.250000000000000_r_def, &
                                -0.250000000000000_r_def, -0.250000000000000_r_def,  0.250000000000000_r_def, &
                                 0.250000000000000_r_def, -0.250000000000000_r_def,  0.250000000000000_r_def, &
                                -0.250000000000000_r_def,  0.250000000000000_r_def,  0.250000000000000_r_def, &
                                 0.250000000000000_r_def,  0.250000000000000_r_def,  0.250000000000000_r_def, &
                                -0.056350832689629_r_def, -0.250000000000000_r_def, -0.056350832689629_r_def, &
                                 0.056350832689629_r_def, -0.250000000000000_r_def, -0.056350832689629_r_def, &
                                -0.443649167310371_r_def,  0.250000000000000_r_def, -0.443649167310371_r_def, &
                                 0.443649167310371_r_def,  0.250000000000000_r_def, -0.443649167310371_r_def, &
                                -0.056350832689629_r_def, -0.250000000000000_r_def,  0.056350832689629_r_def, &
                                 0.056350832689629_r_def, -0.250000000000000_r_def,  0.056350832689629_r_def, &
                                -0.443649167310371_r_def,  0.250000000000000_r_def,  0.443649167310371_r_def, &
                                 0.443649167310371_r_def,  0.250000000000000_r_def,  0.443649167310371_r_def, &
                                -0.443649167310371_r_def, -0.056350832689629_r_def, -0.100000000000000_r_def, &
                                 0.443649167310371_r_def, -0.443649167310371_r_def, -0.787298334620742_r_def, &
                                -0.056350832689629_r_def,  0.056350832689629_r_def, -0.012701665379258_r_def, &
                                 0.056350832689629_r_def,  0.443649167310371_r_def, -0.100000000000000_r_def, &
                                -0.443649167310371_r_def, -0.056350832689629_r_def,  0.100000000000000_r_def, &
                                 0.443649167310371_r_def, -0.443649167310371_r_def,  0.787298334620742_r_def, &
                                -0.056350832689629_r_def,  0.056350832689629_r_def,  0.012701665379258_r_def, &
                                 0.056350832689629_r_def,  0.443649167310371_r_def,  0.100000000000000_r_def, &
                                -0.250000000000000_r_def, -0.056350832689629_r_def, -0.056350832689629_r_def, &
                                 0.250000000000000_r_def, -0.443649167310371_r_def, -0.443649167310371_r_def, &
                                -0.250000000000000_r_def,  0.056350832689629_r_def, -0.056350832689629_r_def, &
                                 0.250000000000000_r_def,  0.443649167310371_r_def, -0.443649167310371_r_def, &
                                -0.250000000000000_r_def, -0.056350832689629_r_def,  0.056350832689629_r_def, &
                                 0.250000000000000_r_def, -0.443649167310371_r_def,  0.443649167310371_r_def, &
                                -0.250000000000000_r_def,  0.056350832689629_r_def,  0.056350832689629_r_def, &
                                 0.250000000000000_r_def,  0.443649167310371_r_def,  0.443649167310371_r_def, &
                                -0.056350832689629_r_def, -0.056350832689629_r_def, -0.012701665379258_r_def, &
                                 0.056350832689629_r_def, -0.443649167310371_r_def, -0.100000000000000_r_def, &
                                -0.443649167310371_r_def,  0.056350832689629_r_def, -0.100000000000000_r_def, &
                                 0.443649167310371_r_def,  0.443649167310371_r_def, -0.787298334620742_r_def, &
                                -0.056350832689629_r_def, -0.056350832689629_r_def,  0.012701665379258_r_def, &
                                 0.056350832689629_r_def, -0.443649167310371_r_def,  0.100000000000000_r_def, &
                                -0.443649167310371_r_def,  0.056350832689629_r_def,  0.100000000000000_r_def, &
                                 0.443649167310371_r_def,  0.443649167310371_r_def,  0.787298334620742_r_def, &
                                -0.100000000000000_r_def, -0.100000000000000_r_def, -0.787298334620742_r_def, &
                                 0.100000000000000_r_def, -0.012701665379258_r_def, -0.100000000000000_r_def, &
                                -0.012701665379258_r_def,  0.100000000000000_r_def, -0.100000000000000_r_def, &
                                 0.012701665379258_r_def,  0.012701665379258_r_def, -0.012701665379258_r_def, &
                                -0.787298334620742_r_def, -0.787298334620742_r_def,  0.787298334620742_r_def, &
                                 0.787298334620742_r_def, -0.100000000000000_r_def,  0.100000000000000_r_def, &
                                -0.100000000000000_r_def,  0.787298334620742_r_def,  0.100000000000000_r_def, &
                                 0.100000000000000_r_def,  0.100000000000000_r_def,  0.012701665379258_r_def, &
                                -0.056350832689629_r_def, -0.100000000000000_r_def, -0.443649167310371_r_def, &
                                 0.056350832689629_r_def, -0.012701665379258_r_def, -0.056350832689629_r_def, &
                                -0.056350832689629_r_def,  0.100000000000000_r_def, -0.443649167310371_r_def, &
                                 0.056350832689629_r_def,  0.012701665379258_r_def, -0.056350832689629_r_def, &
                                -0.443649167310371_r_def, -0.787298334620742_r_def,  0.443649167310371_r_def, &
                                 0.443649167310371_r_def, -0.100000000000000_r_def,  0.056350832689629_r_def, &
                                -0.443649167310371_r_def,  0.787298334620742_r_def,  0.443649167310371_r_def, &
                                 0.443649167310371_r_def,  0.100000000000000_r_def,  0.056350832689629_r_def, &
                                -0.012701665379258_r_def, -0.100000000000000_r_def, -0.100000000000000_r_def, &
                                 0.012701665379258_r_def, -0.012701665379258_r_def, -0.012701665379258_r_def, &
                                -0.100000000000000_r_def,  0.100000000000000_r_def, -0.787298334620742_r_def, &
                                 0.100000000000000_r_def,  0.012701665379258_r_def, -0.100000000000000_r_def, &
                                -0.100000000000000_r_def, -0.787298334620742_r_def,  0.100000000000000_r_def, &
                                 0.100000000000000_r_def, -0.100000000000000_r_def,  0.012701665379258_r_def, &
                                -0.787298334620742_r_def,  0.787298334620742_r_def,  0.787298334620742_r_def, &
                                 0.787298334620742_r_def,  0.100000000000000_r_def,  0.100000000000000_r_def, &
                                -0.100000000000000_r_def, -0.056350832689629_r_def, -0.443649167310371_r_def, &
                                 0.100000000000000_r_def, -0.056350832689629_r_def, -0.443649167310371_r_def, &
                                -0.012701665379258_r_def,  0.056350832689629_r_def, -0.056350832689629_r_def, &
                                 0.012701665379258_r_def,  0.056350832689629_r_def, -0.056350832689629_r_def, &
                                -0.787298334620742_r_def, -0.443649167310371_r_def,  0.443649167310371_r_def, &
                                 0.787298334620742_r_def, -0.443649167310371_r_def,  0.443649167310371_r_def, &
                                -0.100000000000000_r_def,  0.443649167310371_r_def,  0.056350832689629_r_def, &
                                 0.100000000000000_r_def,  0.443649167310371_r_def,  0.056350832689629_r_def, &
                                -0.056350832689629_r_def, -0.056350832689629_r_def, -0.250000000000000_r_def, &
                                 0.056350832689629_r_def, -0.056350832689629_r_def, -0.250000000000000_r_def, &
                                -0.056350832689629_r_def,  0.056350832689629_r_def, -0.250000000000000_r_def, &
                                 0.056350832689629_r_def,  0.056350832689629_r_def, -0.250000000000000_r_def, &
                                -0.443649167310371_r_def, -0.443649167310371_r_def,  0.250000000000000_r_def, &
                                 0.443649167310371_r_def, -0.443649167310371_r_def,  0.250000000000000_r_def, &
                                -0.443649167310371_r_def,  0.443649167310371_r_def,  0.250000000000000_r_def, &
                                 0.443649167310371_r_def,  0.443649167310371_r_def,  0.250000000000000_r_def, &
                                -0.012701665379258_r_def, -0.056350832689629_r_def, -0.056350832689629_r_def, &
                                 0.012701665379258_r_def, -0.056350832689629_r_def, -0.056350832689629_r_def, &
                                -0.100000000000000_r_def,  0.056350832689629_r_def, -0.443649167310371_r_def, &
                                 0.100000000000000_r_def,  0.056350832689629_r_def, -0.443649167310371_r_def, &
                                -0.100000000000000_r_def, -0.443649167310371_r_def,  0.056350832689629_r_def, &
                                 0.100000000000000_r_def, -0.443649167310371_r_def,  0.056350832689629_r_def, &
                                -0.787298334620742_r_def,  0.443649167310371_r_def,  0.443649167310371_r_def, &
                                 0.787298334620742_r_def,  0.443649167310371_r_def,  0.443649167310371_r_def, &
                                -0.100000000000000_r_def, -0.012701665379258_r_def, -0.100000000000000_r_def, &
                                 0.100000000000000_r_def, -0.100000000000000_r_def, -0.787298334620742_r_def, &
                                -0.012701665379258_r_def,  0.012701665379258_r_def, -0.012701665379258_r_def, &
                                 0.012701665379258_r_def,  0.100000000000000_r_def, -0.100000000000000_r_def, &
                                -0.787298334620742_r_def, -0.100000000000000_r_def,  0.100000000000000_r_def, &
                                 0.787298334620742_r_def, -0.787298334620742_r_def,  0.787298334620742_r_def, &
                                -0.100000000000000_r_def,  0.100000000000000_r_def,  0.012701665379258_r_def, &
                                 0.100000000000000_r_def,  0.787298334620742_r_def,  0.100000000000000_r_def, &
                                -0.056350832689629_r_def, -0.012701665379258_r_def, -0.056350832689629_r_def, &
                                 0.056350832689629_r_def, -0.100000000000000_r_def, -0.443649167310371_r_def, &
                                -0.056350832689629_r_def,  0.012701665379258_r_def, -0.056350832689629_r_def, &
                                 0.056350832689629_r_def,  0.100000000000000_r_def, -0.443649167310371_r_def, &
                                -0.443649167310371_r_def, -0.100000000000000_r_def,  0.056350832689629_r_def, &
                                 0.443649167310371_r_def, -0.787298334620742_r_def,  0.443649167310371_r_def, &
                                -0.443649167310371_r_def,  0.100000000000000_r_def,  0.056350832689629_r_def, &
                                 0.443649167310371_r_def,  0.787298334620742_r_def,  0.443649167310371_r_def, &
                                -0.012701665379258_r_def, -0.012701665379258_r_def, -0.012701665379258_r_def, &
                                 0.012701665379258_r_def, -0.100000000000000_r_def, -0.100000000000000_r_def, &
                                -0.100000000000000_r_def,  0.012701665379258_r_def, -0.100000000000000_r_def, &
                                 0.100000000000000_r_def,  0.100000000000000_r_def, -0.787298334620742_r_def, &
                                -0.100000000000000_r_def, -0.100000000000000_r_def,  0.012701665379258_r_def, &
                                 0.100000000000000_r_def, -0.787298334620742_r_def,  0.100000000000000_r_def, &
                                -0.787298334620742_r_def,  0.100000000000000_r_def,  0.100000000000000_r_def, &
                                 0.787298334620742_r_def,  0.787298334620742_r_def,  0.787298334620742_r_def], &
                                [3,8,9,3] )

  end subroutine get_wchi_q3x3x3_diff_basis

!---------------------------------------------------------------------

end module get_unit_test_q3x3x3_basis_mod
